(ns clo-go.board-struct-test
  (:require [midje.sweet :refer :all]
            [clo-go.board-struct :refer :all]))

(fact "board is represented as vector in vector 19x19"
      (board) => [['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]
                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]])

(fact "get color of piece"
      (piece-at [['x]] 0 0) => :black
      (piece-at [['o]] 0 0) => :white
      (piece-at [['-]] 0 0) => :empty)

(fact "same color test"
      (same-color? [['x 'o]] 0 0 0 1) => false
      (same-color? [['x '-]] 0 0 0 1) => false
      (same-color? [['x 'x]] 0 0 0 1) => true
      (same-color? [['o 'o]] 0 0 0 1) => true
      (same-color? [['- '-]] 0 0 0 1) => true
      (same-color? [['x 'o]] :white 0 1) => true
      (same-color? [['x 'o]] :black 0 1) => false
      (not-same-color? [['x 'o]] 0 0 0 1) => true
      (not-same-color? [['x 'x]] 0 0 0 1) => false)

(fact "opposite of black is white, opposite of empty is still empty"
      (opposite :white) => :black
      (opposite :black) => :white
      (opposite :empty) => :empty)

(fact "empty field is special for Go logic"
      (empty-field? [['x]] 0 0) => false
      (empty-field? [['o]] 0 0) => false
      (empty-field? [['-]] 0 0) => true)

(fact "Valid position is any position inside of board"
      (valid-pos? -5 5) => false
      (valid-pos? 5 -5) => false
      (valid-pos? 19 5) => false
      (valid-pos? 5 20) => false
      (valid-pos? 5 15) => true
      (not-valid-pos? 5 5) => false)

(fact "coloring is fun"
      (color-field (board) :white 0 0) => [['O '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]]
      
      (color-field (board) :black 0 0) => [['X '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                           ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]])

(fact "Coloring no mans land"
      (color-field (board) :no-mans-land 0 0) => [['M '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-] 
                                                  ['- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '- '-]])

(fact "It is important to know to whom territory belongs"
      (territory-color [['X]] 0 0) => :black
      (territory-color [['O]] 0 0) => :white
      (territory-color [['-]] 0 0) => :not-territory
      (territory-color [['M]] 0 0) => :no-mans-land
      (territory-color [['x]] 0 0) => :not-territory
      (territory-color [['y]] 0 0) => :not-territory)